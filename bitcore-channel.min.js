require=function t(e,i,n){function s(o,u){if(!i[o]){if(!e[o]){var c="function"==typeof require&&require;if(!u&&c)return c(o,!0);if(r)return r(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var p=i[o]={exports:{}};e[o][0].call(p.exports,function(t){var i=e[o][1][t];return s(i?i:t)},p,p.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e){"use strict";function i(t){t=t||{},this.network=r.get(t.network||"livenet"),this.expires=t.expires||Math.round((new Date).getTime()/1e3)+f,this.commitmentKey=new o(t.commitmentKey),this.providerPublicKey=new u(t.providerPublicKey),this.providerAddress=t.providerAddress?new c(t.providerAddress):this.providerPublicKey.toAddress(),this.fundingKey=t.fundingKey||new o,this.fundingAddress=this.fundingKey.toAddress(),t.refundAddress?this.refundAddress=t.refundAddress instanceof c?t.refundAddress:new c(t.refundAddress):(this.refundKey=new o,this.refundAddress=new c(this.refundKey.publicKey,this.network)),this.commitmentTx=new p({publicKeys:[this.commitmentKey.publicKey,this.providerPublicKey],network:this.network})}var n=t("bitcore").util.preconditions,s=t("bitcore").Script,r=t("bitcore").Networks,o=t("bitcore").PrivateKey,u=t("bitcore").PublicKey,c=t("bitcore").Address,a=t("bitcore").deps._,p=t("./transactions/commitment"),d=t("./transactions/payment"),h=t("./transactions/refund"),m=24,y=60,b=60,f=b*y*m;i.prototype.processFunding=function(t){n.checkArgument(a.isObject(t),"Can only process an array of objects or an object"),this.commitmentTx.from(t)},i.prototype.setupRefund=function(){this.commitmentTx.sign(this.fundingKey),n.checkState(this.commitmentTx.isFullySigned());var t=this.commitmentTx.amount,e={txid:this.commitmentTx.id,outputIndex:0,satoshis:t,script:this.commitmentTx.outputs[0].script};return this.refundTx=(new h).from(e,this.commitmentTx.publicKeys,2).change(this.refundAddress),this.refundTx.inputs[0].sequenceNumber=0,this.refundTx._updateChangeOutput(),this.refundTx.nLockTime=this.expires,this.refundTx},i.prototype.validateRefund=function(t){t=new h(t),t.sign(this.commitmentKey),n.checkState(new c(t.outputs[0].script,this.network).toString()===this.refundAddress.toString());var e=t.outputs[0].satoshis;n.checkState(e+t._estimateFee()===this.commitmentTx.amount),n.checkState(1===t.outputs.length,"More than expected outputs received"),n.checkState(t.isFullySigned(),"Refund was not fully signed"),n.checkState(s.Interpreter().verify(t.inputs[0].script,t.inputs[0].output.script),"Refund is incorrectly signed"),this.refundTx=t;var i={txid:this.commitmentTx.hash,outputIndex:0,satoshis:e,script:this.commitmentTx.outputs[0].script};return this.paymentTx=new d({multisigOut:i,amount:e,paymentAddress:this.providerAddress,changeAddress:this.refundAddress,publicKeys:this.commitmentTx.publicKeys,network:this.network}),this.paymentTx.sign(this.commitmentKey),!0},i.prototype.incrementPaymentBy=function(t){return this.paymentTx.updateValue(t),this.paymentTx.sign(this.commitmentKey),this.paymentTx.toObject()},i.prototype.getPaymentTx=function(){return this.paymentTx},e.exports=i},{"./transactions/commitment":4,"./transactions/payment":5,"./transactions/refund":6,bitcore:"bitcore"}],2:[function(t,e){"use strict";var i={name:"Channel",message:"Internal Error on bitcore-channels Module {0}"};e.exports=t("bitcore").errors.extend(i)},{bitcore:"bitcore"}],3:[function(t,e){"use strict";function i(t){this.network=a.get(t.network)||a.defaultNetwork,t.paymentAddress?this.paymentAddress=new c(t.paymentAddress):(this.paymentKey=new o,this.paymentAddress=this.paymentKey.toAddress(this.network)),this.currentAmount=t.currentAmount||0,this.key=t.key||new o}var n=t("./transactions/payment"),s=t("./transactions/refund"),r=t("bitcore").util.preconditions,o=t("bitcore").PrivateKey,u=t("bitcore").Script,c=t("bitcore").Address,a=t("bitcore").Networks,p=t("bitcore").deps._;i.prototype.getPublicKey=function(){return this.key.publicKey},i.prototype.signRefund=function(t){var e=new s(t);return e.sign(this.key),this.refund=e,e},i.prototype.validPayment=function(t){var e,i=new n(t),s=this;return i.sign(this.key),i.outputs.map(function(t){t.script.toAddress(s.network).toString()===s.paymentAddress.toString()&&(e=t.satoshis)}),r.checkState(u.Interpreter().verify(i.inputs[0].script,i.inputs[0].output.script),"Script did not evaluate correctly (probably a bad signature received)"),r.checkState(!p.isUndefined(e)&&e>this.currentAmount,"A payment for a greater amount was already received"),this.paymentTx=i,this.currentAmount=e,i},i.prototype.getPaymentTx=function(){return this.paymentTx.build()},e.exports=i},{"./transactions/payment":5,"./transactions/refund":6,bitcore:"bitcore"}],4:[function(t,e){"use strict";function i(t){s.checkArgument(t.publicKeys&&2===t.publicKeys.length,"Must provide exactly two public keys"),c.call(this,t.transaction),this.network=t.network||"livenet",this.publicKeys=t.publicKeys,this.outscript=u.buildMultisigOut(this.publicKeys,2),this.address=o(this.outscript,this.network),this.change(this.address),this.keys=t.keys?a.map(t.keys,function(t){return new r(t)}):[],Object.defineProperty(this,"amount",{configurable:!1,get:function(){return this._inputAmount}}),this._updateChange=void 0}var n=t("inherits"),s=t("bitcore").util.preconditions,r=t("bitcore").PrivateKey,o=t("bitcore").Address,u=t("bitcore").Script,c=t("bitcore").Transaction,a=t("bitcore").deps._;n(i,c),i.prototype.toObject=function(){var t=c.prototype.toObject.apply(this);return{transaction:t,publicKeys:a.map(this.publicKeys,function(t){return t.toString()}),network:this.network.toString(),keys:a.map(this.keys,function(t){return t.toString()})}},i.prototype.getAddress=function(){return this.address},i.prototype.addKey=function(t){this.keys.push(t)},e.exports=i},{bitcore:"bitcore",inherits:7}],5:[function(t,e){"use strict";function i(t){return this instanceof i?(r.call(this,t.transaction),this.paymentAddress=new s(t.paymentAddress),this._change=new s(t.changeAddress),this.multisigOut=new r.UnspentOutput(t.multisigOut),this.publicKeys=c.map(t.publicKeys,o),this.inputs.length||this.from(this.multisigOut,this.publicKeys,2),this.outputs.length<2&&this._updateChangeOutput(),this.amount=this._outputAmount,this.sequence=t.sequence||0,this._fee=a,this.paid=t.paid||0,u.checkArgument(c.isNumber(this.amount),"Amount must be a number"),void(this._changeSetup=void 0)):new i(t)}var n=t("inherits"),s=t("bitcore").Address,r=t("bitcore").Transaction,o=t("bitcore").Publickey,u=t("bitcore").util.preconditions,c=t("bitcore").deps._,a=1e4;n(i,r),i.prototype._updateTransaction=function(){this.outputs=[],this._changeOutput=void 0,this._outputAmount=0,this.to(this.paymentAddress,this.paid),this.inputs[0].sequence=this.sequence,this._changeSetup=!1},i.prototype.updateValue=function(t){return this.paid+=t,this.sequence+=1,this._updateTransaction(),this},i.prototype.toObject=function(){return{publicKeys:c.map(this.publicKeys,function(t){return t.toString()}),multisigOut:this.multisigOut.toObject(),amount:this.amount,sequence:this.sequence,paymentAddress:this.paymentAddress.toString(),changeAddress:this._change.toString(),transaction:r.prototype.toObject.apply(this)}},i.fromObject=function(t){return new i(t)},e.exports=i},{bitcore:"bitcore",inherits:7}],6:[function(t,e){"use strict";function i(){s.apply(this,arguments),this._changeSetup=void 0}var n=t("inherits"),s=t("bitcore").Transaction;n(i,s),e.exports=i},{bitcore:"bitcore",inherits:7}],7:[function(t,e){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],"bitcore-channel":[function(t,e){t("./lib/errors"),e.exports={Consumer:t("./lib/consumer"),Provider:t("./lib/provider"),Transactions:{Commitment:t("./lib/transactions/commitment"),Refund:t("./lib/transactions/refund"),Payment:t("./lib/transactions/payment")}}},{"./lib/consumer":1,"./lib/errors":2,"./lib/provider":3,"./lib/transactions/commitment":4,"./lib/transactions/payment":5,"./lib/transactions/refund":6}]},{},[]);